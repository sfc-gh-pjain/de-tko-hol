/*
Created By: Parag Jain

Created For: End to End Data Engineering HOL

AFTER RUNNING THIS SHEET, GO BACK TO JUPYTER NOTEBOOK TO SHOW THE ACTUAL TRANSFORMATIONS
*/

use role sysadmin;
use schema de_demo_tko_hol.telco;
use warehouse lab_l_wh;


select * from raw_parquet;

create or replace TABLE DEMOGRAPHICS (
	CUSTOMERID VARCHAR(16777216),
	COUNT NUMBER(38,0),
	GENDER VARCHAR(16777216),
	SENIORCITIZEN BOOLEAN,
	PARTNER BOOLEAN,
	DEPENDENTS BOOLEAN
);

create or replace TABLE LOCATION (
	CUSTOMERID VARCHAR(16777216),
	COUNTRY VARCHAR(16777216),
	STATE VARCHAR(16777216),
	CITY VARCHAR(16777216),
	ZIPCODE NUMBER(38,0),
	LATLONG VARCHAR(16777216),
	LATITUDE VARCHAR(16777216),
	LONGITUDE VARCHAR(16777216)
);


create or replace TABLE SERVICES (
	CUSTOMERID VARCHAR(16777216),
	TENUREMONTHS NUMBER(38,0),
	PHONESERVICE BOOLEAN,
	MULTIPLELINES VARCHAR(16777216),
	INTERNETSERVICE VARCHAR(16777216),
	ONLINESECURITY VARCHAR(16777216),
	ONLINEBACKUP VARCHAR(16777216),
	DEVICEPROTECTION VARCHAR(16777216),
	TECHSUPPORT VARCHAR(16777216),
	STREAMINGTV VARCHAR(16777216),
	STREAMINGMOVIES VARCHAR(16777216),
	CONTRACT VARCHAR(16777216),
	PAPERLESSBILLING BOOLEAN,
	PAYMENTMETHOD VARCHAR(16777216),
	MONTHLYCHARGES FLOAT,
	TOTALCHARGES FLOAT,
	CHURNVALUE NUMBER(38,0)
);

create or replace TABLE STATUS (
	CUSTOMERID VARCHAR(16777216),
	CHURNLABEL BOOLEAN,
	CHURNVALUE FLOAT,
	CHURNSCORE NUMBER(38,0),
	CLTV NUMBER(38,0),
	CHURNREASON VARCHAR(16777216)
);


